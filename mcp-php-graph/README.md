# mcp-graphy

MCP сервер для анализа PHP проектов. Предоставляет инструменты для индексации, поиска символов, анализа наследования и зависимостей в PHP коде.

## Возможности

- **Индексация проекта** - автоматическое сканирование и индексация PHP файлов с поддержкой нескольких директорий
- **Поиск символов** - поиск классов, интерфейсов, трейтов и enum по полному имени (FQN)
- **Анализ наследования** - получение информации о том, кто наследует класс или реализует интерфейс
- **Поиск использований** - нахождение всех файлов, которые используют указанный класс
- **Статистика индекса** - получение общей статистики по проиндексированным файлам
- **Автоматическое обновление** - отслеживание изменений в файлах через файловые вотчеры

## Установка

```bash
npm install
npm run build
```

## Использование

Запуск MCP сервера:

```bash
npm start
```

Или через бинарный файл:

```bash
./build/index.js
```

## Доступные инструменты

### init_project

Инициализирует индексацию PHP проекта. Поддерживает один или несколько путей.

**Параметры:**
- `paths` (array) - массив абсолютных путей к папкам проекта
- `ignore` (array, опционально) - глобальный список паттернов для игнорирования

**Пример:**
```json
{
  "paths": ["/path/to/project"],
  "ignore": ["**/vendor/**", "**/node_modules/**"]
}
```

### search_symbol

Найти PHP класс/интерфейс/трейт/enum и получить путь к файлу.

**Параметры:**
- `query` (string) - имя символа (например `App\User` или `App\\User`)

**Пример:**
```json
{
  "query": "App\\Models\\User"
}
```

### get_inheritance

Получить информацию о наследовании: кто наследует класс и кто реализует интерфейс.

**Параметры:**
- `fqn` (string) - полное имя класса или интерфейса

**Пример:**
```json
{
  "fqn": "App\\BaseController"
}
```

### get_usages

Найти файлы, которые используют указанный класс.

**Параметры:**
- `fqn` (string) - полное имя класса (FQN)

**Пример:**
```json
{
  "fqn": "App\\Services\\AuthService"
}
```

### get_graph_stats

Получить статистику индекса.

**Параметры:** нет

## Разработка

```bash
# Сборка проекта
npm run build

# Запуск в режиме watch
npm run watch

# Запуск тестов
npm test
```

## Лицензия

MIT

